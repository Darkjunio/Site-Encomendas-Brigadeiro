<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Encomendas de Brigadeiro</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #fff8f5;
    margin: 0; padding: 0 10px 80px 10px;
    color: #333;
  }
  header {
    text-align: center;
    padding: 20px 10px;
    background: #e91e63;
    color: white;
    font-weight: bold;
  }
  h1, h2 {
    margin-bottom: 10px;
  }
  .sabores, .combos {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }
  .card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 7px rgb(0 0 0 / 0.1);
    width: 160px;
    padding: 15px;
    text-align: center;
    user-select: none;
  }
  .card img {
    width: 100%;
    height: 90px;
    object-fit: cover;
    border-radius: 6px;
    margin-bottom: 10px;
  }
  .card button {
    margin-top: 10px;
    background: #e91e63;
    border: none;
    color: white;
    padding: 8px 14px;
    font-size: 14px;
    border-radius: 4px;
    cursor: pointer;
  }
  .quantidade {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 5px;
  }
  .quantidade button {
    background: #c2185b;
    border: none;
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 4px;
    font-weight: bold;
    cursor: pointer;
  }
  .quantidade span {
    margin: 0 10px;
    font-weight: bold;
  }
  /* Carrinho flutuante */
  #carrinho-flutuante {
    position: fixed;
    bottom: 15px;
    right: 15px;
    width: 300px;
    max-height: 400px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 3px 12px rgb(0 0 0 / 0.3);
    overflow-y: auto;
    padding: 15px;
    z-index: 9999;
    font-size: 14px;
  }
  #carrinho-flutuante h3 {
    margin-top: 0;
    margin-bottom: 10px;
  }
  #carrinho-flutuante ul {
    list-style: none;
    padding: 0;
    margin: 0 0 10px 0;
    max-height: 250px;
    overflow-y: auto;
  }
  #carrinho-flutuante li {
    display: flex;
    justify-content: space-between;
    padding: 6px 4px;
    border-bottom: 1px solid #eee;
  }
  #carrinho-flutuante li button {
    background: #c2185b;
    border: none;
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
  }
  #total-carrinho {
    font-weight: bold;
    margin-bottom: 10px;
  }
  #btn-finalizar {
    width: 100%;
    background: #25d366;
    border: none;
    color: white;
    padding: 10px;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
  }
  /* Modal */
  #modal-fundo {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 9998;
    justify-content: center;
    align-items: center;
  }
  #modal {
    background: white;
    border-radius: 10px;
    max-width: 400px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    padding: 20px;
  }
  #modal h3 {
    margin-top: 0;
  }
  #modal .form-check {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
  }
  #modal .form-check label {
    flex-grow: 1;
    user-select: none;
  }
  #modal input[type=number] {
    width: 50px;
    margin-left: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 2px 6px;
  }
  #btn-confirmar {
    background: #e91e63;
    color: white;
    border: none;
    padding: 10px;
    width: 100%;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 15px;
  }
  #btn-cancelar {
    background: #999;
    color: white;
    border: none;
    padding: 8px;
    width: 100%;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 8px;
  }
  /* Alert custom */
  #alerta {
    position: fixed;
    top: 15px;
    right: 15px;
    background: #e91e63;
    color: white;
    padding: 12px 18px;
    border-radius: 6px;
    box-shadow: 0 3px 10px rgb(0 0 0 / 0.3);
    font-weight: bold;
    z-index: 10000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
  }
  /* Responsivo */
  @media (max-width: 600px) {
    #carrinho-flutuante {
      width: 60px;
      height: 60px;
      padding: 0;
      border-radius: 50%;
      box-shadow: 0 3px 10px rgb(0 0 0 / 0.4);
      overflow: visible;
      cursor: pointer;
    }
    #carrinho-flutuante.open {
      width: 90vw;
      height: auto;
      border-radius: 10px;
      padding: 15px;
      max-height: 50vh;
      overflow-y: auto;
    }
    #carrinho-flutuante h3,
    #carrinho-flutuante ul,
    #total-carrinho,
    #btn-finalizar {
      display: none;
    }
    #carrinho-flutuante.open h3,
    #carrinho-flutuante.open ul,
    #carrinho-flutuante.open #total-carrinho,
    #carrinho-flutuante.open #btn-finalizar {
      display: block;
    }
  }
</style>
</head>
<body>

<header>
  <h1>üç´ Encomendas de Brigadeiro</h1>
  <p>Entrega somente na faculdade | WhatsApp: (61) 99376-8275</p>
</header>

<section>
  <h2>Sabores Individuais - R$ 3,00/un</h2>
  <div class="sabores" id="sabores-container">
    <!-- Cards ser√£o inseridos via JS -->
  </div>
</section>

<section>
  <h2>Combos Promocionais</h2>
  <div class="combos">
    <div class="card">
      <h3>Combo 6 unidades - R$ 16,00</h3>
      <button onclick="abrirModalSabores(6, 16, 'Combo 6 unidades')">Escolher Sabores</button>
    </div>
    <div class="card">
      <h3>Combo 12 unidades + Caixa Decorada - R$ 30,00</h3>
      <button onclick="abrirModalSabores(12, 30, 'Combo 12 unidades')">Escolher Sabores</button>
    </div>
    <div class="card">
      <h3>Combo Surpresa 6 unidades - R$ 18,00</h3>
      <button onclick="adicionarComboSurpresa(6, 18)">Adicionar ao Carrinho</button>
    </div>
    <div class="card">
      <h3>Combo Surpresa 12 unidades - R$ 35,00</h3>
      <button onclick="adicionarComboSurpresa(12, 35)">Adicionar ao Carrinho</button>
    </div>
  </div>
</section>

<div id="carrinho-flutuante" title="Clique para abrir o carrinho">
  <h3>Carrinho (<span id="contador-carrinho">0</span>)</h3>
  <ul id="lista-carrinho"></ul>
  <p id="total-carrinho">Total: R$ 0.00</p>
  <button id="btn-finalizar">Finalizar Pedido via WhatsApp</button>
</div>

<!-- Modal de escolha de sabores -->
<div id="modal-fundo">
  <div id="modal">
    <h3>Escolha os Sabores</h3>
    <p id="modal-info"></p>
    <div id="modal-sabores-list"></div>
    <button id="btn-confirmar" disabled>Confirmar</button>
    <button id="btn-cancelar">Cancelar</button>
  </div>
</div>

<!-- Alert -->
<div id="alerta"></div>

<script>
  const sabores = [
    { nome: "Ninho", img: "https://source.unsplash.com/160x90/?brigadeiro,ninho" },
    { nome: "Tradicional", img: "https://source.unsplash.com/160x90/?brigadeiro" },
    { nome: "Morango", img: "https://source.unsplash.com/160x90/?brigadeiro,morango" },
    { nome: "Ninho com Nutella", img: "https://source.unsplash.com/160x90/?brigadeiro,nutella" },
    { nome: "Meio Amargo", img: "https://source.unsplash.com/160x90/?brigadeiro,chocolate" },
    { nome: "Beijinho", img: "https://source.unsplash.com/160x90/?brigadeiro,beijinho" },
  ];

  const precoUnitario = 3;

  let carrinho = [];

  // Renderizar sabores individuais
  const saboresContainer = document.getElementById("sabores-container");
  sabores.forEach(sabor => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${sabor.img}" alt="${sabor.nome}">
      <h4>${sabor.nome}</h4>
      <div class="quantidade">
        <button onclick="alterarQtd('${sabor.nome}', -1)">-</button>
        <span id="qtd-${sabor.nome}">0</span>
        <button onclick="alterarQtd('${sabor.nome}', 1)">+</button>
      </div>
      <button onclick="adicionarSaborCarrinho('${sabor.nome}')">Adicionar</button>
    `;
    saboresContainer.appendChild(card);
  });

  function alterarQtd(nome, delta) {
    const span = document.getElementById(`qtd-${nome}`);
    let qtd = parseInt(span.textContent);
    qtd += delta;
    if (qtd < 0) qtd = 0;
    span.textContent = qtd;
  }

  function adicionarSaborCarrinho(nome) {
    const qtd = parseInt(document.getElementById(`qtd-${nome}`).textContent);
    if (qtd <= 0) {
      mostrarAlerta("Selecione a quantidade antes de adicionar");
      return;
    }
    const itemExistente = carrinho.find(i => i.nome === nome && !i.combo);
    if (itemExistente) {
      itemExistente.qtd += qtd;
    } else {
      carrinho.push({ nome, preco: precoUnitario, qtd, combo: false });
    }
    document.getElementById(`qtd-${nome}`).textContent = '0';
    atualizarCarrinho();
    mostrarAlerta(`${qtd}x ${nome} adicionado ao carrinho`);
  }

  // Modal para combos
  const modalFundo = document.getElementById("modal-fundo");
  const modalSaboresList = document.getElementById("modal-sabores-list");
  const modalInfo = document.getElementById("modal-info");
  const btnConfirmar = document.getElementById("btn-confirmar");
  const btnCancelar = document.getElementById("btn-cancelar");

  let comboAtualQtd = 0;
  let comboAtualPreco = 0;
  let comboAtualNome = "";

  function abrirModalSabores(qtdMax, preco, nome) {
    comboAtualQtd = qtdMax;
    comboAtualPreco = preco;
    comboAtualNome = nome;

    modalSaboresList.innerHTML = "";
    modalInfo.textContent = `Escolha at√© ${qtdMax} unidades somando os sabores`;

    sabores.forEach(sabor => {
      const id = `check-${sabor.nome.replace(/\s+/g, '')}`;
      modalSaboresList.innerHTML += `
        <div class="form-check">
          <label>
            <input type="checkbox" id="${id}" />
            ${sabor.nome}
            <input type="number" min="1" max="${qtdMax}" value="1" id="qtd-${id}" disabled style="margin-left:8px; width:50px;" />
          </label>
        </div>
      `;
    });

    // Adicionar listeners checkbox/inputs
    const checkboxes = modalSaboresList.querySelectorAll("input[type='checkbox']");
    checkboxes.forEach(cb => {
      const inputQtd = document.getElementById(`qtd-${cb.id}`);
      cb.addEventListener("change", () => {
        inputQtd.disabled = !cb.checked;
        if (!cb.checked) inputQtd.value = 1;
        validarQtdTotal();
      });
      inputQtd.addEventListener("input", () => {
        if (inputQtd.value < 1) inputQtd.value = 1;
        if (inputQtd.value > qtdMax) inputQtd.value = qtdMax;
        validarQtdTotal();
      });
    });

    btnConfirmar.disabled = true;
    modalFundo.style.display = "flex";
    validarQtdTotal();
  }

  function validarQtdTotal() {
    const checkboxes = modalSaboresList.querySelectorAll("input[type='checkbox']");
    let total = 0;
    checkboxes.forEach(cb => {
      if (cb.checked) {
        const inputQtd = document.getElementById(`qtd-${cb.id}`);
        total += Number(inputQtd.value) || 0;
      }
    });
    if (total === 0 || total > comboAtualQtd) {
      btnConfirmar.disabled = true;
    } else {
      btnConfirmar.disabled = false;
    }
  }

  btnConfirmar.addEventListener("click", () => {
    const checkboxes = modalSaboresList.querySelectorAll("input[type='checkbox']");
    let totalSelecionado = 0;
    let detalhes = [];
    checkboxes.forEach(cb => {
      if (cb.checked) {
        const inputQtd = document.getElementById(`qtd-${cb.id}`);
        const qtd = Number(inputQtd.value);
        totalSelecionado += qtd;
        detalhes.push(`${cb.parentElement.textContent.trim()} x${qtd}`);
      }
    });
    if (totalSelecionado === 0) {
      mostrarAlerta("Selecione pelo menos um sabor");
      return;
    }
    if (totalSelecionado > comboAtualQtd) {
      mostrarAlerta(`Quantidade m√°xima permitida √© ${comboAtualQtd}`);
      return;
    }
    carrinho.push({
      nome: comboAtualNome,
      preco: comboAtualPreco,
      qtd: 1,
      combo: true,
      detalhes: detalhes.join(", ")
    });
    atualizarCarrinho();
    fecharModal();
  });

  btnCancelar.addEventListener("click", fecharModal);
  function fecharModal() {
    modalFundo.style.display = "none";
  }

  // Combo surpresa
  function adicionarComboSurpresa(qtd, preco) {
    carrinho.push({
      nome: `Combo Surpresa ${qtd} unidades`,
      preco: preco,
      qtd: 1,
      combo: true,
      detalhes: "Sabores surpresa"
    });
    atualizarCarrinho();
    mostrarAlerta(`Combo Surpresa ${qtd} unidades adicionado`);
  }

  // Atualizar carrinho
  const carrinhoFlutuante = document.getElementById("carrinho-flutuante");
  const listaCarrinho = document.getElementById("lista-carrinho");
  const totalCarrinho = document.getElementById("total-carrinho");
  const contadorCarrinho = document.getElementById("contador-carrinho");

  function atualizarCarrinho() {
    listaCarrinho.innerHTML = "";
    let total = 0;
    let totalItens = 0;

    carrinho.forEach((item, index) => {
      total += item.preco * item.qtd;
      totalItens += item.qtd;
      const li = document.createElement("li");
      li.textContent = `${item.nome}${item.combo && item.detalhes ? ": " + item.detalhes : ""} x${item.qtd} - R$ ${(item.preco * item.qtd).toFixed(2)}`;

      const btnRemover = document.createElement("button");
      btnRemover.textContent = "X";
      btnRemover.title = "Remover item";
      btnRemover.onclick = () => {
        carrinho.splice(index, 1);
        atualizarCarrinho();
      };

      li.appendChild(btnRemover);
      listaCarrinho.appendChild(li);
    });
    totalCarrinho.textContent = `Total: R$ ${total.toFixed(2)}`;
    contadorCarrinho.textContent = totalItens;

    // Responsivo mobile - muda a apresenta√ß√£o do carrinho
    if(window.innerWidth <= 600) {
      carrinhoFlutuante.classList.remove("open");
    } else {
      carrinhoFlutuante.classList.add("open");
    }
  }

  // Finalizar pedido via WhatsApp
  document.getElementById("btn-finalizar").addEventListener("click", () => {
    if (carrinho.length === 0) {
      mostrarAlerta("Carrinho vazio!");
      return;
    }
    let nomeCliente = prompt("Digite seu nome para o pedido:");
    if (!nomeCliente || nomeCliente.trim() === "") {
      mostrarAlerta("Nome √© obrigat√≥rio.");
      return;
    }
    let dataEntrega = prompt("Digite a data de entrega (AAAA-MM-DD):");
    if (!dataEntrega || !/^\d{4}-\d{2}-\d{2}$/.test(dataEntrega)) {
      mostrarAlerta("Data inv√°lida.");
      return;
    }
    let mensagem = `*Pedido de Brigadeiros*%0ANome: ${encodeURIComponent(nomeCliente)}%0AEntrega: Faculdade%0AData: ${encodeURIComponent(dataEntrega)}%0A%0APedido:%0A`;
    carrinho.forEach(item => {
      mensagem += `- ${encodeURIComponent(item.nome)}`;
      if(item.combo && item.detalhes){
        mensagem += ` (${encodeURIComponent(item.detalhes)})`;
      }
      mensagem += ` x${item.qtd} - R$ ${(item.preco * item.qtd).toFixed(2)}%0A`;
    });
    const total = carrinho.reduce((acc, i) => acc + i.preco * i.qtd, 0);
    mensagem += `%0ATotal: R$ ${total.toFixed(2)}`;

    // Envia pro WhatsApp
    window.open(`https://wa.me/5561993768275?text=${mensagem}`, "_blank");
  });

  // Alert personalizado
  const alerta = document.getElementById("alerta");
  let alertaTimeout;
  function mostrarAlerta(texto){
    alerta.textContent = texto;
    alerta.style.opacity = "1";
    alerta.style.pointerEvents = "auto";
    clearTimeout(alertaTimeout);
    alertaTimeout = setTimeout(() => {
      alerta.style.opacity = "0";
      alerta.style.pointerEvents = "none";
    }, 3000);
  }

  // Toggle carrinho mobile
  carrinhoFlutuante.addEventListener("click", () => {
    if(window.innerWidth <= 600){
      carrinhoFlutuante.classList.toggle("open");
    }
  });

  // Inicializa sabores
  atualizarCarrinho();

  // Fecha modal se clicar fora
  modalFundo.addEventListener("click", e => {
    if(e.target === modalFundo) fecharModal();
  });
</script>

</body>
</html>
